;/*FB_PKG_DELIM*/

__d("WAWebSingleCallDropdownContent.react",["fbt","WAWebActionMenuItem.react","WAWebAddUserIcon.react","WAWebCalendarFilledRefreshedIcon.react","WAWebCallCollection","WAWebCallDropdownMenuItems.react","WAWebContactImage.react","WAWebEnvironment","WAWebFlex.react","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebModalManager","WAWebText.react","WAWebUISpacing","WAWebUserSubtitle.react","WAWebVoipCallsTabScheduleCallModal.react","WAWebVoipCreateCallLinksPopupLoadable.react","WAWebVoipNewGroupCallContactPicker.react","WAWebWamEnumSubSurface","WDSIconIcCallFilled.react","WDSIconIcLink.react","WDSIconIcVideocamFilled.react","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c=u||(u=r("react")),d=(e||(e=o("react"))).useEffect,m={dropdownContainer:{width:"xj6ak53",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},contactTextContainer:{minWidth:"xeuugli",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},callButtonsRow:{width:"xh8yej3",rowGap:"x1qvou4u",columnGap:"x1s70e7g",marginTop:"x1380le5",marginBottom:"xat24cr",$$css:!0},callButtonWrapper:{flex:"x1cqoux5",minWidth:"xeuugli",$$css:!0},callButtonMenuItemIcon:{color:"x1pse0pq",height:"xxk0z11",width:"xvy4d1p",$$css:!0},actionsContainer:{width:"xh8yej3",$$css:!0},actionItemIcon:{color:"xhslqc4",$$css:!0}};function p(e){var t,n=e.chat,a=e.enableWebGroupCalling,i=e.handleCall,l=e.isCallingDisabled,u=e.logger,p=e.onActionTaken,_=e.onClose,f=n.contact,g=o("WAWebFrontendContactGetters").getFormattedUser(f),h=o("WAWebFrontendChatGetters").getPresence(n);return d(function(){var e=r("WAWebCallCollection").activeCall;e!=null&&e.shouldShowPostCallSurvey===!0&&r("WAWebCallCollection").setActiveCall(null),u.clickCallDropdown(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER)},[u]),c.jsxs((t=o("WAWebFlex.react")).FlexColumn,{xstyle:[o("WAWebUISpacing").uiPadding.all8,m.dropdownContainer],grow:1,gap:8,children:[c.jsxs(t.FlexRow,{align:"center",children:[c.jsx(r("WAWebContactImage.react"),{contact:f,size:40,loadPicture:!0}),c.jsxs(t.FlexColumn,{xstyle:[o("WAWebUISpacing").uiPadding.start12,m.contactTextContainer],grow:1,children:[c.jsx(t.FlexItem,{children:c.jsx(o("WAWebText.react").WAWebTextTitle,{textWrap:"ellipsis",children:g})}),c.jsx(t.FlexItem,{children:c.jsx(r("WAWebUserSubtitle.react"),{contact:f,presence:h,chatstate:h.chatstate,location:"title",chatId:n.id})})]})]}),c.jsxs(t.FlexRow,{xstyle:m.callButtonsRow,children:[c.jsx(t.FlexItem,{grow:1,xstyle:m.callButtonWrapper,children:c.jsx(o("WAWebCallDropdownMenuItems.react").CallButtonMenuItem,{optionId:"voice-call",testid:void 0,icon:c.jsx(r("WDSIconIcCallFilled.react"),{iconXstyle:m.callButtonMenuItemIcon}),disabled:l,label:s._(/*BTDS*/"Voice"),onSelect:function(){u.clickAudioCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),p(),i(!1),_()}})}),c.jsx(o("WAWebFlex.react").FlexItem,{grow:1,xstyle:m.callButtonWrapper,children:c.jsx(o("WAWebCallDropdownMenuItems.react").CallButtonMenuItem,{optionId:"video-call",testid:void 0,icon:c.jsx(r("WDSIconIcVideocamFilled.react"),{iconXstyle:m.callButtonMenuItemIcon}),disabled:l,label:s._(/*BTDS*/"Video"),onSelect:function(){u.clickVideoCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),p(),i(!0),_()}})})]}),(!r("WAWebEnvironment").isWeb||a)&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"xjm9jq1 x3x0x6p xh8yej3 xav9cv8 x4tpdpg"}),c.jsxs(o("WAWebFlex.react").FlexColumn,{xstyle:m.actionsContainer,children:[c.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"new-group-call",detailLeft:c.jsx(o("WAWebAddUserIcon.react").AddUserIcon,{xstyle:m.actionItemIcon}),primary:c.jsx(o("WAWebText.react").WAWebTextTitle,{color:"secondary",children:s._(/*BTDS*/"New group call")}),onSelect:function(){p(),u.clickAddContact(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),o("WAWebModalManager").ModalManager.open(c.jsx(r("WAWebVoipNewGroupCallContactPicker.react"),{chat:n,showCallTypeButtons:!0})),_()}}),c.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"send-call-link",detailLeft:c.jsx(r("WDSIconIcLink.react"),{testid:void 0,xstyle:m.actionItemIcon}),primary:c.jsx(o("WAWebText.react").WAWebTextTitle,{color:"secondary",children:s._(/*BTDS*/"Send call link")}),onSelect:function(){p(),u.clickCreateVideoCallLinkChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),o("WAWebModalManager").ModalManager.open(c.jsx(o("WAWebVoipCreateCallLinksPopupLoadable.react").WAWebVoipCreateCallLinksPopupLoadable,{targetChat:n})),_()}}),c.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"schedule-call",detailLeft:c.jsx(o("WAWebCalendarFilledRefreshedIcon.react").CalendarFilledRefreshedIcon,{xstyle:m.actionItemIcon}),primary:c.jsx(o("WAWebText.react").WAWebTextTitle,{color:"secondary",children:s._(/*BTDS*/"Schedule call")}),onSelect:function(){p(),u.clickCreateEventChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),o("WAWebVoipCallsTabScheduleCallModal.react").handleScheduleCallForChat(n),_()}})]})]})]})}p.displayName=p.name+" [from "+i.id+"]",l.default=p}),226);
__d("WAWebVoipBetaCallingUpsellPopover.react",["fbt","WAWebFlex.react","WAWebText.react","WAWebUISpacing","WDSButton.react","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=r("react")),c={container:{minWidth:"x1h80ny7",$$css:!0},textContainer:{maxWidth:"x1jkqq1h",$$css:!0},buttonContainer:{height:"x5yr21d",$$css:!0}};function d(e){var t,n,a=e.onClick;return u.jsxs((t=o("WAWebFlex.react")).FlexRow,{xstyle:[c.container,(n=o("WAWebUISpacing")).uiPadding.horiz20,n.uiPadding.bottom14,n.uiPadding.top12],align:"center",justify:"all",children:[u.jsxs(t.FlexColumn,{xstyle:c.textContainer,children:[u.jsx(t.FlexItem,{children:u.jsx(o("WAWebText.react").WAWebTextTitle,{children:s._(/*BTDS*/"Try new one-on-one web calling")})}),u.jsx(t.FlexItem,{xstyle:n.uiMargin.top2,children:u.jsx(o("WAWebText.react").WAWebTextMuted,{children:s._(/*BTDS*/"Join the WhatsApp Beta program to start making calls on web. Note: testing version may be unstable")})})]}),u.jsx(t.FlexColumn,{xstyle:c.buttonContainer,align:"center",justify:"center",children:u.jsx(t.FlexItem,{xstyle:n.uiMargin.start16,children:u.jsx(r("WDSButton.react"),{variant:"filled",size:"medium",label:s._(/*BTDS*/"Switch to beta"),onPress:a})})})]})}d.displayName=d.name+" [from "+i.id+"]",l.default=d}),226);
__d("WAWebVoipCallingNux.react",["fbt","WAWebBox.react","WAWebClickable.react","WAWebDropdownV2.react","WAWebFbtCommon","WAWebFlex.react","WAWebNux","WAWebPopoverContext.react","WAWebTooltip.react","WAWebUimUie.react","WDSIconIcClose.react","WDSText.react","react","useWAWebNux","useWAWebStableCallback"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=o("react")),c=e.useEffect,d={row:{minHeight:"xu0aao5",$$css:!0},tooltip:{paddingTop:"x1xrf6ya",paddingInlineEnd:"xde1mab",paddingBottom:"xscbp6u",paddingInlineStart:"x1iw51ew",borderStartStartRadius:"xlr9sxt",borderStartEndRadius:"xvvg52n",borderEndEndRadius:"xwd4zgb",borderEndStartRadius:"xq8v1ta",$$css:!0},arrow:{marginTop:"xdj266r",marginInlineEnd:"x14z9mp",marginBottom:"xat24cr",marginInlineStart:"x1sbwfh8",$$css:!0},button:{borderStartStartRadius:"xt8t1vi",borderStartEndRadius:"x1xc408v",borderEndEndRadius:"x129tdwq",borderEndStartRadius:"x15urzxu",$$css:!0},content:{rowGap:"x1b73lln",columnGap:"x46w9ns",$$css:!0},closeButton:{marginInlineStart:"x150mmf0",$$css:!0}};function m(e){var t=e.nuxKey,n=e.targetRef,a=r("useWAWebNux")(t),i=a[0],l=a[1],m=a[2],p=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef();c(function(){if(i&&n.current!=null){var e;(e=p.current)==null||e.showPopover()}},[i,p,n]);var _=r("useWAWebStableCallback")(function(){var e;m(),(e=p.current)==null||e.hidePopover()});if(!i)return null;var f=t===o("WAWebNux").NUX.WEB_CALLING_1_1_NUX?s._(/*BTDS*/"One-on-one web calls"):s._(/*BTDS*/"Calling on web"),g=s._(/*BTDS*/"Talk live over audio or video");return u.jsx(o("WAWebUimUie.react").UIE,{popable:!0,escapable:!0,dismissOnWindowResize:!0,displayName:"VoipCallingNux",requestDismiss:_,children:u.jsx(r("WAWebBox.react"),{testid:void 0,children:u.jsx(o("WAWebPopoverContext.react").WAWebPopoverController,{targetRef:n,controllerRef:p,popover:u.jsx(o("WAWebTooltip.react").WAWebControllableTooltip,{target:"context",alignment:o("WAWebDropdownV2.react").PopoverAlignment.Center,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,enableEnterTransition:!0,enableExitTransition:!0,tooltipXStyle:d.tooltip,arrowXStyle:d.arrow,includeArrow:!0,element:u.jsxs(o("WAWebFlex.react").FlexRow,{xstyle:d.row,align:"center",justify:"all",children:[u.jsxs(o("WAWebFlex.react").FlexColumn,{xstyle:d.content,children:[u.jsx(r("WDSText.react"),{type:"Body2Emphasized",colorName:"contentInverse",children:f}),u.jsx(r("WDSText.react"),{type:"Body3",colorName:"contentInverse",children:g})]}),u.jsx(o("WAWebClickable.react").Clickable,{as:"button",onClick:_,xstyle:[d.button,d.closeButton],ariaLabel:r("WAWebFbtCommon")("Close"),children:u.jsx(r("WDSIconIcClose.react"),{colorName:"contentInverse",width:20,height:20})})]})})})})})}m.displayName=m.name+" [from "+i.id+"]",l.default=m}),226);
__d("WAWebVoipCoexCallingPermissionDisabledModal.react",["fbt","WAWebConfirmPopup.react","WAWebModalManager","react"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u=e||(e=r("react"));function c(){return u.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{title:s._(/*BTDS*/"You can't call this customer right now"),onOK:o("WAWebModalManager").closeModalManager,okText:s._(/*BTDS*/"OK"),testid:void 0,children:s._(/*BTDS*/"They declined your call request. You can still message or accept calls from them.")})}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),226);
__d("WAWebCallButtons.react",["fbt","$InternalEnum","WALogger","WANullthrows","WAWebActionMenuItem.react","WAWebAddUserIcon.react","WAWebButton.react","WAWebCallButtonsSurface","WAWebCallCollection","WAWebCallLogUtils","WAWebChatGetters","WAWebChatsOutlineIcon.react","WAWebContactCollection","WAWebDesktopUpsellCallingUnavailablePopover.react","WAWebDesktopUpsellUtils","WAWebDrawerManager","WAWebDropdownV2.react","WAWebEnvironment","WAWebFrontendContactGetters","WAWebGroupCallParticipantSelector.react","WAWebGroupMetadataCollection","WAWebLidMigrationUtils","WAWebMenuBar.react","WAWebMenuBarStyles","WAWebMobilePlatforms","WAWebModalManager","WAWebMsgGetters","WAWebNux","WAWebPopoverContext.react","WAWebPreCallUserJourneyLogger","WAWebScreenWidthThresholds","WAWebSettingsConst","WAWebSettingsFlowLoadable","WAWebSingleCallDropdownContent.react","WAWebTabOrder","WAWebUnstyledButton.react","WAWebUserPrefsMeUser","WAWebVoipActionRequestOpenChat","WAWebVoipBetaCallingUpsellPopover.react","WAWebVoipCallingNux.react","WAWebVoipCoexCallingPermissionDisabledModal.react","WAWebVoipGatingUtils","WAWebVoipOngoingCallCollection","WAWebVoipStackInterface","WAWebVoipStartCall","WAWebWamEnumLobbyEntryPointType","WAWebWamEnumSubSurface","WDSButton.react","WDSIconIcArrowDropDown.react","WDSIconIcCall.react","WDSIconIcVideocam.react","WDSMenuBarItem.react","WDSText.react","asyncToGeneratorRuntime","fbs","getErrorSafe","isStringNullOrEmpty","nullthrows","react","stylex","useWAWebABPropConfigValue","useWAWebEventTargetValue","useWAWebExternalBetaOptIn","useWAWebIsWinHybridJoinableCallsEnabled","useWAWebMsgValues","useWAWebVoipCanStartCall","useWAWebVoipIsCallingEnabledAndInited","useWAWebWindowSize"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R=S||(S=o("react")),L=b||(b=r("react")),E=R.useMemo,k=R.useRef,I=R.useState,T=n("$InternalEnum").Mirrored(["NONE","BETA","DESKTOP"]),D={callDropdownShadow:{boxShadow:"xs2e80n",$$css:!0},callButtonIcon:{color:"x14ug900",height:"x1qx5ct2",width:"xw4jnvo",$$css:!0},customCallButton:{alignItems:"x6s0dn4",backgroundColor:"x1280gxy x1ubxc9n",borderTopColor:"xnj1f2r",borderInlineEndColor:"x2uibgs",borderBottomColor:"xkveyfu",borderInlineStartColor:"x12llq9",borderStartStartRadius:"xt8t1vi",borderStartEndRadius:"x1xc408v",borderEndEndRadius:"x129tdwq",borderEndStartRadius:"x15urzxu",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",columnGap:"x1s70e7g",cursor:"x1ypdohk x1s07b3s",display:"x78zum5",minHeight:"x1ba4aug",opacity:"x1hc1fzr x1lfpgzf",paddingTop:"x16ovd2e",paddingBottom:"x12xbjc7",paddingInlineStart:"xdx6fka",paddingInlineEnd:"xvtqlqk",paddingLeft:null,paddingRight:null,$$css:!0},buttonMargin:{marginInlineStart:"x150mmf0",$$css:!0},unifiedButtonMargin:{marginInlineStart:"x150mmf0",marginInlineEnd:"xqf2s3x",$$css:!0}};function x(t){var a,i,l,b=t.callFromUI,S=b===void 0?0:b,R=t.callLinkCode,x=R===void 0?"":R,$=t.chat,P=t.isCallLinkVideo,N=P===void 0?!1:P,M=t.isStartCallDisabled,w=M===void 0?!1:M,A=t.lobbyEntryPoint,F=A===void 0?0:A,O=t.participants,B=t.surface,W=o("useWAWebVoipIsCallingEnabledAndInited").useWAWebVoipIsCallingEnabledAndInited(),q=o("useWAWebIsWinHybridJoinableCallsEnabled").useIsWinHybridJoinableCallsEnabled(),U=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_lid_call_link"),V=o("useWAWebABPropConfigValue").useABPropConfigValue("add_to_call_in_chat_thread")>0,H=r("useWAWebEventTargetValue")(o("WAWebVoipOngoingCallCollection").WAWebVoipOngoingCallCollection,"all",function(){return o("WAWebVoipOngoingCallCollection").WAWebVoipOngoingCallCollection.getByChat($)}),G=o("useWAWebMsgValues").useOptionalMsgValues((a=H==null?void 0:H.id)!=null?a:null,[o("WAWebMsgGetters").getCallParticipants,o("WAWebMsgGetters").getTerminatedByDeviceSwitch]),z=(i=G==null?void 0:G[0])!=null?i:null,j=(l=G==null?void 0:G[1])!=null?l:null,K=o("WAWebChatGetters").getIsGroup($),Q=!o("useWAWebVoipCanStartCall").useWAWebVoipCanStartCall($)||w,X=o("useWAWebVoipCanStartCall").useWAWebVoipIsCapiCallingPermissionAllowed($),Y=k(null),J=k(null),Z=k(null),ee=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef(),te=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef(),ne=o("WAWebPopoverContext.react").useWAWebPopoverControllerRef(),re=k(!1),oe=I(!1),ae=oe[0],ie=oe[1],le=E(function(){return new(o("WAWebPreCallUserJourneyLogger")).PreCallUserJourneyLogger},[]),se=o("useWAWebABPropConfigValue").useABPropConfigValue("wds_web_button"),ue=o("WAWebVoipGatingUtils").isGroupCallingEnabled(),ce=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_web_calling_nux")&&!r("WAWebEnvironment").isWindows,de=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_web_calling_beta_upsell"),me=o("useWAWebABPropConfigValue").useABPropConfigValue("group_call_max_participants"),pe=r("useWAWebWindowSize")(),_e=pe.width<o("WAWebScreenWidthThresholds").NARROW_SCREEN_THRESHOLD,fe=o("useWAWebABPropConfigValue").useABPropConfigValue("enable_unified_call_buttons_in_chat")&&B!==o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&B!==o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.IconOnly,ge=o("useWAWebABPropConfigValue").useABPropConfigValue("unified_calling_entry_point_desktop_type"),he=r("useWAWebEventTargetValue")(r("WAWebCallCollection"),"change:activeCall",function(){return r("WAWebCallCollection").activeCall}),ye=function(){if(H==null||he==null)return!1;var e=he.id,t=o("WAWebMsgGetters").getCallId(H);return e===t},Ce=function(){return H==null||ye()?!1:o("WAWebCallLogUtils").getIsSelfConnected(z)},be=function(){var e=o("WAWebCallLogUtils").getJoinButtonTextType(ye(),Ce(),j);return e==="return"?r("fbs")._(/*BTDS*/"Return"):e==="join_here"?r("fbs")._(/*BTDS*/"Join here"):e==="join"?r("fbs")._(/*BTDS*/"Join"):(function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+e)})()},ve=o("useWAWebExternalBetaOptIn").useExternalBetaOptIn(),Se=ve[0],Re=o("WAWebDesktopUpsellUtils").getUserDesktopOs(),Le=T.NONE;if(r("WAWebEnvironment").isWeb){if(!W&&o("WAWebVoipGatingUtils").isCallingEnabled())return null;if(K){var Ee,ke,Ie,Te=r("WAWebGroupMetadataCollection").get($.id.toString()),De=(Ee=(ke=Te==null?void 0:Te.size)!=null?ke:Te==null||(Ie=Te.participants)==null?void 0:Ie.length)!=null?Ee:0;if(De>me)return null;if(!o("WAWebVoipGatingUtils").isGroupCallingEnabled())if(Re!=null)Le=T.DESKTOP;else return null}else if(!o("WAWebVoipGatingUtils").isCallingEnabled())if(!Se&&de)Le=T.BETA;else if(Re!=null)Le=T.DESKTOP;else return null}var xe=Le!==T.NONE,$e=K?s._(/*BTDS*/"Group voice call"):s._(/*BTDS*/"Voice call"),Pe=K?s._(/*BTDS*/"Group video call"):s._(/*BTDS*/"Video call"),Ne=function(n){if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip: header: start call, isVideo: ",", groupType: ",""])),n,$.groupType),!X){o("WAWebModalManager").ModalManager.open(L.jsx(r("WAWebVoipCoexCallingPermissionDisabledModal.react"),{}));return}O!=null&&O.length>1?(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["voip: header: starting ad hoc group call"]))),o("WAWebVoipStartCall").startWAWebVoipGroupCallFromWids(O,n,S,F)):$.groupType===void 0?(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["voip: header: starting 1:1 call"]))),o("WAWebVoipStartCall").startWAWebVoipCall($.contact.id,n,S,F)):(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["voip: header: starting group call"]))),o("WAWebVoipStartCall").startWAWebVoipGroupCallFromChat($,n,S,F))},Me=function(t){var e,n=t?ee:te;(e=n.current)==null||e.hidePopover()};if(q&&H!=null&&!o("WAWebMsgGetters").getIsCallLink(H)&&$.id.isGroup())return L.jsx("div",babelHelpers.extends({},(v||(v=r("stylex"))).props(r("WAWebMenuBarStyles").itemButton,D.buttonMargin),{children:L.jsx(r("WDSButton.react"),{label:be(),Icon:H.isVideoCall?r("WDSIconIcVideocam.react"):r("WDSIconIcCall.react"),variant:"filled",onPress:function(){o("WAWebVoipStartCall").joinOngoingWAWebVoipGroupCallPN(r("nullthrows")(o("WAWebMsgGetters").getCallId(H)),$,o("WAWebMsgGetters").getIsVideoCall(H),B===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails?o("WAWebWamEnumLobbyEntryPointType").LOBBY_ENTRY_POINT_TYPE.CALL_LOG:o("WAWebWamEnumLobbyEntryPointType").LOBBY_ENTRY_POINT_TYPE.CHAT_HEADER)}})}));if(B===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&!r("isStringNullOrEmpty")(x))return L.jsx("div",babelHelpers.extends({},(v||(v=r("stylex"))).props(r("WAWebMenuBarStyles").itemButton,D.buttonMargin),{children:L.jsxs(o("WAWebButton.react").WAWebButtonPrimaryCompact,{onClick:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link: CallLinkCode=",", isVideo=",""])),x,N);try{var e=yield o("WAWebVoipStackInterface").getVoipStackInterface();if(x){var t=o("WAWebContactCollection").ContactCollection.getMeContact(),n=t?o("WAWebFrontendContactGetters").getUsername(t):null;yield e==null?void 0:e.previewCallLink(x,N!=null?N:!1,U,o("WAWebWamEnumLobbyEntryPointType").LOBBY_ENTRY_POINT_TYPE.CALL_LINK_CALL_LOG,n),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link initiated successfully"])))}else o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link failed - CallLinkCode is empty"])))}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["voip: preview call link failed"]))).catching(r("getErrorSafe")(e))}}),children:[N?L.jsx(r("WDSIconIcVideocam.react"),{}):L.jsx(r("WDSIconIcCall.react"),{}),r("fbs")._(/*BTDS*/"Join")]})}));var we=function(t){var e=t?L.jsx(r("WDSIconIcVideocam.react"),{}):L.jsx(r("WDSIconIcCall.react"),{}),n=t?Pe:$e,a=t?Y:J,i=t?ee:te;return se?L.jsxs(L.Fragment,{children:[L.jsx(r("WDSMenuBarItem.react"),{ref:a,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,title:n,icon:r(t?"WDSIconIcVideocam.react":"WDSIconIcCall.react"),disabled:Q,marginInlineXstyle:D.buttonMargin}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:i,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:a,maxHeight:488,onClose:function(){re.current||le.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.ADD_PARTICIPANT_PICKER),re.current=!1},children:L.jsx(r("WAWebGroupCallParticipantSelector.react"),{chat:$,icon:e,isCallingDisabled:Q,isVideo:t,logger:le,onActionTaken:function(){re.current=!0},onCallStart:Me,useUnifiedUI:!1},$.id.toString())})]}):L.jsxs(L.Fragment,{children:[L.jsx(o("WAWebMenuBar.react").MenuBarItem,{ref:a,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:e,disabled:Q,title:n}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:i,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:a,maxHeight:488,onClose:function(){re.current||le.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.ADD_PARTICIPANT_PICKER),re.current=!1},children:L.jsx(r("WAWebGroupCallParticipantSelector.react"),{chat:$,icon:e,isCallingDisabled:Q,isVideo:t,logger:le,onActionTaken:function(){re.current=!0},onCallStart:Me},$.id.toString())})]})},Ae=function(){return Le===T.BETA?L.jsx(r("WAWebVoipBetaCallingUpsellPopover.react"),{onClick:function(){var e,t,n;(e=ee.current)==null||e.hidePopover(),(t=te.current)==null||t.hidePopover(),(n=ne.current)==null||n.hidePopover(),o("WAWebDrawerManager").DrawerManager.openDrawerLeft(L.jsx(o("WAWebSettingsFlowLoadable").SettingsFlowLoadable,{onEnd:o("WAWebDrawerManager").closeDrawerLeft,initialStep:o("WAWebSettingsConst").SettingsSteps.Help}))}}):Le===T.DESKTOP?L.jsx(r("WAWebDesktopUpsellCallingUnavailablePopover.react"),{userDesktopOs:r("WANullthrows")(Re),isGroupCall:K}):null},Fe=function(){if(xe){var e=Ae();return L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{ref:Y,xstyle:[D.customCallButton,D.unifiedButtonMargin],dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Pe,"aria-haspopup":"menu","aria-expanded":ae,children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:ee,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Y,maxHeight:488,children:e})]})}var t=L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:ee,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Y,maxHeight:488,onOpen:function(){ie(!0)},onClose:function(){ie(!1),re.current||le.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.ADD_PARTICIPANT_PICKER),re.current=!1},children:L.jsx(r("WAWebGroupCallParticipantSelector.react"),{chat:$,icon:L.jsx(r("WDSIconIcVideocam.react"),{}),isCallingDisabled:Q,isVideo:!0,logger:le,onActionTaken:function(){re.current=!0},onCallStart:Me,useUnifiedUI:!0},$.id.toString())});return ge===0?L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{ref:Y,xstyle:[D.customCallButton,D.unifiedButtonMargin],disabled:Q,dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Pe,children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),t]}):L.jsxs(L.Fragment,{children:[L.jsx(r("WDSButton.react"),{variant:"borderless",size:"medium",type:"default",ref:Y,Icon:r("WDSIconIcVideocam.react"),showEndDropdownIcon:!0,disabled:Q,onPress:function(){var e;le.clickCallDropdown(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER),(e=ee.current)==null||e.showPopover()},"aria-label":Pe}),t]})},Oe=function(){if(he==null)return!1;if(K&&he.isGroup){var e,t;return(e=(t=he.groupJid)==null?void 0:t.equals($.id))!=null?e:!1}if(!K&&he.groupCallParticipants!=null)return he.groupCallParticipants.some(function(e){var t,n=o("WAWebLidMigrationUtils").toCommonAddressingMode(e,$.id),r=n[0],a=n[1];return(t=r==null?void 0:r.equals(a))!=null?t:!1});if(!K&&!he.isGroup){var n,r=o("WAWebLidMigrationUtils").toCommonAddressingMode(he.peerJid,$.id),a=r[0],i=r[1];return(n=a==null?void 0:a.equals(i))!=null?n:!1}return!1},Be=_e||o("WAWebMobilePlatforms").isSMB(),We=function(){if(xe){var e=Ae();return L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{testid:void 0,ref:Z,xstyle:[D.customCallButton,D.unifiedButtonMargin],dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Pe,role:"button",children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),!Be&&L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:ne,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Z,maxHeight:488,children:e})]})}return L.jsxs(L.Fragment,{children:[L.jsxs(r("WAWebUnstyledButton.react"),{testid:void 0,ref:Z,xstyle:[D.customCallButton,D.unifiedButtonMargin],disabled:Q,dataTab:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,"aria-label":Pe,role:"button",children:[L.jsx(r("WDSIconIcVideocam.react"),{iconXstyle:D.callButtonIcon}),!Be&&L.jsx(r("WDSText.react"),{type:"Body2Emphasized",textAlign:"center",selectable:!1,colorName:"contentDefault",children:s._(/*BTDS*/"Call")}),L.jsx(r("WDSIconIcArrowDropDown.react"),{iconXstyle:D.callButtonIcon})]}),L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:ne,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Z,maxHeight:488,onClose:function(){re.current||le.dismissChatThread(o("WAWebWamEnumSubSurface").SUB_SURFACE.CALL_DROPDOWN_MENU),re.current=!1},children:L.jsx(r("WAWebSingleCallDropdownContent.react"),{chat:$,handleCall:Ne,isCallingDisabled:Q,logger:le,onActionTaken:function(){re.current=!0},onClose:function(){var e;return(e=ne.current)==null?void 0:e.hidePopover()},enableWebGroupCalling:ue})})]})},qe=function(t){if(!V||he==null)return!1;var e=Oe();return e?!1:he.isGroup&&he.groupJid==null?!0:he.isGroup?!1:t&&he.isVideo||!t&&!he.isVideo},Ue=function(t){if(t?le.clickVideoCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER):le.clickAudioCall(o("WAWebWamEnumSubSurface").SUB_SURFACE.CHAT_HEADER),qe(t)){var e,n=t?ee:te;(e=n.current)==null||e.showPopover()}else Ne(t)},Ve=function(){if(fe&&ge===0)return We();var e=Q,t=Q;if(V){var a=Oe();a?(e=!0,t=!0):he!=null&&(he.isGroup&&he.groupJid!=null?(e=!0,t=!0):(e=!he.isVideo,t=he.isVideo))}var i=se?L.jsx(r("WDSMenuBarItem.react"),{ref:Y,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:r("WDSIconIcVideocam.react"),onClick:function(){return Ue(!0)},disabled:e,title:Pe,marginInlineXstyle:D.buttonMargin}):L.jsx(o("WAWebMenuBar.react").MenuBarItem,{ref:Y,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:L.jsx(r("WDSIconIcVideocam.react"),{}),onClick:function(){return Ue(!0)},disabled:e,title:Pe}),l=se?L.jsx(r("WDSMenuBarItem.react"),{ref:J,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:r("WDSIconIcCall.react"),onClick:function(){return Ue(!1)},disabled:t,title:$e,marginInlineXstyle:D.buttonMargin}):L.jsx(o("WAWebMenuBar.react").MenuBarItem,{ref:J,tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:L.jsx(r("WDSIconIcCall.react"),{}),onClick:function(){return Ue(!1)},disabled:t,title:$e}),u=qe(!0)?L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:ee,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:Y,maxHeight:488,children:L.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"add-to-call-video",detailLeft:L.jsx(o("WAWebAddUserIcon.react").AddUserIcon,{}),primary:s._(/*BTDS*/"Add to call"),onSelect:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call clicked for video call with chat: ",""])),$.id.toString());try{yield o("WAWebVoipStartCall").inviteToCall($.id)}catch(e){o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call failed for ",""])),$.id.toString()).catching(r("getErrorSafe")(e))}(e=ee.current)==null||e.hidePopover()})})}):null,c=qe(!1)?L.jsx(o("WAWebDropdownV2.react").DropdownV2Menu,{xstyle:D.callDropdownShadow,controllerRef:te,position:o("WAWebDropdownV2.react").PopoverPosition.Bottom,alignment:o("WAWebDropdownV2.react").PopoverAlignment.End,target:J,maxHeight:488,children:L.jsx(o("WAWebActionMenuItem.react").ActionMenuItem,{optionId:"add-to-call-voice",detailLeft:L.jsx(o("WAWebAddUserIcon.react").AddUserIcon,{}),primary:s._(/*BTDS*/"Add to call"),onSelect:n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call clicked for voice call with chat: ",""])),$.id.toString());try{yield o("WAWebVoipStartCall").inviteToCall($.id)}catch(e){o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["voip: add to call failed for ",""])),$.id.toString()).catching(r("getErrorSafe")(e))}(e=te.current)==null||e.hidePopover()})})}):null;return L.jsxs(L.Fragment,{children:[i,u,l,c]})},He=function(){if($.id.isGroup())return!0;if(O==null)return!1;var e=O.filter(function(e){return!o("WAWebUserPrefsMeUser").isMeAccount(e)});return e.length<=1},Ge=Ve();return L.jsxs(L.Fragment,{children:[B===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&He()&&se&&L.jsx(r("WDSMenuBarItem.react"),{tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:o("WAWebChatsOutlineIcon.react").ChatsOutlineIcon,onClick:function(){return o("WAWebVoipActionRequestOpenChat").requestOpenChat($.id)},title:r("fbs")._(/*BTDS*/"Messages"),marginInlineXstyle:D.buttonMargin}),B===o("WAWebCallButtonsSurface").WAWebCallButtonsSurface.CallLogDetails&&He()&&!se&&L.jsx(o("WAWebMenuBar.react").MenuBarItem,{tabOrder:o("WAWebTabOrder").TAB_ORDER.CHAT_HEADER_BUTTON,testid:void 0,icon:L.jsx(o("WAWebChatsOutlineIcon.react").ChatsOutlineIcon,{}),onClick:function(){return o("WAWebVoipActionRequestOpenChat").requestOpenChat($.id)},title:r("fbs")._(/*BTDS*/"Messages")}),K&&fe&&Fe(),K&&fe&&ge===1&&L.jsx("div",{className:"xamitd3 x3x0x6p xxk0z11 x1i1rx1s"}),K&&!fe&&L.jsxs(L.Fragment,{children:[we(!0),we(!1)]}),!K&&Ge,!K&&ce&&o("WAWebVoipGatingUtils").isCallingEnabled()&&L.jsx(r("WAWebVoipCallingNux.react"),{targetRef:Z,nuxKey:o("WAWebNux").NUX.WEB_CALLING_1_1_NUX}),K&&fe&&ce&&o("WAWebVoipGatingUtils").isGroupCallingEnabled()&&L.jsx(r("WAWebVoipCallingNux.react"),{targetRef:Y,nuxKey:o("WAWebNux").NUX.WEB_CALLING_GROUP_NUX})]})}x.displayName=x.name+" [from "+i.id+"]",l.WAWebCallButtons=x}),226);
__d("WAWebOrchestratorJobEventSampling",[],(function(t,n,r,o,a,i){var e={sendMessage:10,createLidPnMappings:10,updateLidMetadata:10,getAllUserDisclosures:10,handleBusinessNotification:5,syncMyDeviceList:5,receiptBatcherRunActiveBatches:5,updateDraftMessageChat:5},l={JOB_EVENT_SAMPLING_RATE:e};i.default=l}),66);